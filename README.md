# WEBéšèº«ç›¾æš´éœ²é¢æ”¶æ•›é…ç½®æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç» WEBéšèº«ç›¾ç½‘å…³é’ˆå¯¹æš´éœ²é¢æ”¶æ•›åœºæ™¯çš„æ’ä»¶ç¼–å†™æ–¹æ¡ˆã€‚é€šè¿‡é€‚é…åº”ç”¨çš„è®¤è¯æœºåˆ¶ï¼Œå®ç°åº”ç”¨é›¶æ”¹é€ çš„æš´éœ²é¢æ”¶æ•›ã€‚

## é€‚ç”¨åœºæ™¯

**âœ… é€‚åˆä½¿ç”¨é›¶æ”¹é€ å¼•æ“è§„åˆ™çš„åœºæ™¯ï¼š**

- ä¼ä¸šå†…éƒ¨åº”ç”¨ï¼ˆOA/ERP/è´¢åŠ¡/CRMç­‰ï¼‰éœ€è¦æš´éœ²é¢æ”¶æ•›
- å¸Œæœ›åœ¨ä¸ä¿®æ”¹åº”ç”¨ä»£ç çš„æƒ…å†µä¸‹ï¼Œå®ç°æš´éœ²é¢æ”¶æ•›
- éœ€è¦å¼±å¯†ç å®æ—¶æ‹¦æˆªå’Œæš´åŠ›ç ´è§£é˜²æŠ¤
- éœ€è¦éšè—åç«¯æœåŠ¡æ¥å£ï¼Œé™ä½è¢«æ‰«æå’Œæ”»å‡»é£é™©
- éœ€è¦æ»¡è¶³ç­‰ä¿ã€æ•°æ®å®‰å…¨æ³•ç­‰åˆè§„è¦æ±‚

**âŒ ä¸é€‚åˆçš„åœºæ™¯ï¼š**

- çº¯é™æ€ç½‘ç«™ï¼ˆæ— éœ€è®¤è¯ï¼‰
- éœ€è¦æ·±åº¦å®šåˆ¶è®¤è¯æµç¨‹ä¸”æ— æ³•é€šè¿‡é…ç½®å®ç°

**ğŸš€ å¿«é€Ÿå¼€å§‹ï¼š** å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œå»ºè®®å…ˆé˜…è¯» [5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md](5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md)

## æ–‡æ¡£ç›®å½•

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [FAQ.md](FAQ.md) | â­ **æ–°æ‰‹ä¸Šè·¯å¿…è¯»** WEBéšèº«ç›¾å¸¸è§é—®é¢˜ |
| **[5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md](5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md)** | â­ **æ–°æ‰‹ä¸Šè·¯å¿…è¯»**ï¼šæœ€å°åŒ–é…ç½®ç¤ºä¾‹ã€åˆ†æ­¥é…ç½®æŒ‡å—ã€å¸¸è§åœºæ™¯æ¨¡æ¿ã€å¿«é€ŸéªŒè¯æ–¹æ³• |
| **[å¿«é€Ÿå¼€å§‹.md](å¿«é€Ÿå¼€å§‹.md)** | â­ **æ–°æ‰‹ä¸Šè·¯å¿…è¯»**ï¼šå¿«é€Ÿå¼€å§‹æ–‡æ¡£  |
| **[åº”ç”¨æ’ä»¶æ–‡æ¡£.md](åº”ç”¨æ’ä»¶æ–‡æ¡£.md)** | â­ **æ–°æ‰‹ä¸Šè·¯å¿…è¯»**ï¼šåº”ç”¨æ’ä»¶ç¼–å†™æ–‡æ¡£ |
| [ç™½åå•.md](ç™½åå•.md) | ç™½åå•é…ç½®æ–‡æ¡£ |
| [exposure_auth.md](exposure_auth.md) | æš´éœ²é¢è®¤è¯æ’ä»¶ï¼ŒåŸºäº WISID æˆ–åº”ç”¨è‡ªèº« cookie/header è¿›è¡Œèº«ä»½éªŒè¯ |
| [exposure_login.md](exposure_login.md) | ç™»å½•æ¥å£æ’ä»¶ï¼ŒHook åº”ç”¨ç™»å½•æ¥å£ï¼Œåˆ¤å®šç™»å½•æˆåŠŸ/å¤±è´¥ |
| [exposure_session.md](exposure_session.md) | ç”¨æˆ·ä¼šè¯å¤„ç†æ¨¡å— |
| [exposure_user.md](exposure_user.md) | ç”¨æˆ·ä¿¡æ¯è·å–æ’ä»¶ï¼Œé€šè¿‡å­è¯·æ±‚è·å–ç”¨æˆ·èº«ä»½ä¿¡æ¯ |
| [uri_bypass.md](uri_bypass.md) | æ­£åˆ™ç™½åå• URI æ’ä»¶ï¼ŒåŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„ç™½åå•é…ç½® |
| [uri_blocker.md](uri_blocker.md) | è¯·æ±‚å¤´æ£€æµ‹ä¸æ‹¦æˆª |
| [request_blocker.md](request_blocker.md) | è¯·æ±‚ä½“æ£€æµ‹ä¸æ‹¦æˆª |
| [passwd_bruteforce.md](passwd_bruteforce.md) | ç™»å½•å£æš´åŠ›ç ´è§£æ£€æµ‹ä¸æ‹¦æˆª |
| [passwd_capture.md](passwd_capture.md) | ç™»å½•å£å¯†ç æ•è· |
| [passwd_restriction.md](passwd_restriction.md) | ç™»å½•å£å¼±å¯†ç æ£€æµ‹ä¸æ‹¦æˆª |
| [sub-route.md](sub-route.md) | å­è·¯ç”±é…ç½®æ–‡æ¡£ï¼ŒåŸºäº radixtree çš„é«˜æ•ˆè·¯ç”±åŒ¹é… |
| [ctx-var.md](ctx-var.md) | è¯·æ±‚ä¸Šä¸‹æ–‡å˜é‡æ–‡æ¡£ï¼Œæ”¯æŒçš„ `$xxx` å˜é‡è¯´æ˜ |
| [lua-resty-expr.md](lua-resty-expr.md) | è¡¨è¾¾å¼è¯­æ³•æ–‡æ¡£ï¼Œç”¨äºæ¡ä»¶åˆ¤å®š |
| [path-syntax.md](path-syntax.md) | è·¯å¾„æå–è¯­æ³•æ–‡æ¡£ï¼ŒJSON/XML è·¯å¾„è¯­æ³•è¯´æ˜ |
| [å˜é‡åˆ†ç±»è¯´æ˜.md](å˜é‡åˆ†ç±»è¯´æ˜.md) | å˜é‡åˆ†ç±»è¯´æ˜æ–‡æ¡£ï¼Œæ¶µç›–ä¸‰ç§å˜é‡ï¼Œç³»ç»Ÿå†…éƒ¨å˜é‡ï¼Œè¿‡ç¨‹å†…éƒ¨å˜é‡ï¼Œç”¨æˆ·è‡ªå®šä¹‰å˜é‡ |
| [æ¡ä»¶è¡¨è¾¾å¼.md](æ¡ä»¶è¡¨è¾¾å¼.md) | æ¡ä»¶è¡¨è¾¾å¼ |
| [ä¸šåŠ¡æµç¨‹æ¶æ„å›¾.md](ä¸šåŠ¡æµç¨‹æ¶æ„å›¾.md) | ä¸šåŠ¡æµç¨‹æ¶æ„å›¾ |
| [å­è·¯ç”±.md](å­è·¯ç”±.md) | å­è·¯ç”±é…ç½®æ–‡æ¡£ |
| [æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½ä¼˜åŒ–æŒ‡å—.md](æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½ä¼˜åŒ–æŒ‡å—.md) | æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½ä¼˜åŒ–æŒ‡å—ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ€§ç¼–å†™çš„æ³¨æ„äº‹é¡¹ |
| [æ’ä»¶åˆè§„æ€§å®¡è®¡æ¸…å•.md](æ’ä»¶åˆè§„æ€§å®¡è®¡æ¸…å•.md) | æ’ä»¶åˆè§„æ€§å®¡è®¡æ¸…å•ï¼Œç”¨äºå®¡è®¡æ’ä»¶æ˜¯å¦ç¬¦åˆæ–°å¼•æ“è§„èŒƒ |
| [plugin-config.schema.json](plugin-config.schema.json) | æ’ä»¶é…ç½® JSON Schemaï¼Œç”¨äºç»“æ„æ ¡éªŒä¸ IDE æ”¯æŒ |
| [Cursor+HARç¼–å†™é›¶æ”¹é€ æ’ä»¶è§„åˆ™å®è·µæ‰‹å†Œ.md](Cursor+HARç¼–å†™é›¶æ”¹é€ æ’ä»¶è§„åˆ™å®è·µæ‰‹å†Œ.md) | Cursor+HAR ç¼–å†™é›¶æ”¹é€ æ’ä»¶è§„åˆ™å®è·µæ‰‹å†Œ |

## æ ¸å¿ƒæ¨¡å—

é’ˆå¯¹æš´éœ²é¢æ”¶æ•›åœºæ™¯ï¼Œé™¤äº†é˜²æ”»å‡»çš„é€šç”¨æ¨¡å—å¤–ï¼ŒæŠ½è±¡å‡ºå››ä¸ªä¸šåŠ¡ç›¸å…³çš„æ ¸å¿ƒæ¨¡å—ï¼š

| æ¨¡å—åç§° | ç”¨é€” |
|---------|------|
| `exposure_auth` | æš´éœ²é¢æ”¶æ•›çš„é‰´æƒæ¨¡å—ï¼Œç”¨æˆ·é…ç½®æœªå¾—åˆ°WISIDè®¤è¯æ—¶å€™çš„å¤„ç†æ–¹å¼ |
| `exposure_login` | Hook åº”ç”¨çš„ç™»å½•æ¥å£ï¼Œåˆ¤å®šç™»å½•è¯·æ±‚çš„æˆåŠŸ/å¤±è´¥ï¼Œæ”¯æŒå¯†ç ç­–ç•¥ |
| `exposure_user` | åˆ¤å®šè¯·æ±‚æ˜¯å¦å·²ç™»å½•ï¼ŒåŒæ—¶è·å–ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼ˆuser_idã€user_nameï¼‰ |
| `exposure_session` |  å®šä¹‰å¦‚ä½•è®¾ç½®WISIDä¼šè¯

**è¯¦ç»†è¯´æ˜è§ï¼š** [5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md](5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md#æ ¸å¿ƒæ¦‚å¿µ2åˆ†é’Ÿç†è§£)

## ä»£ç æ’ä»¶é…ç½®ä¼˜å…ˆçº§

```
ä»£ç æ’ä»¶å†…è”é…ç½® > åº”ç”¨ä½œç”¨åŸŸé…ç½® > å…¨å±€é»˜è®¤é…ç½®
```

å³ï¼š**å±€éƒ¨æ’ä»¶ç»„é…ç½® > åº”ç”¨ä½œç”¨åŸŸé…ç½® > å…¨å±€ä½œç”¨åŸŸé…ç½®**

### ä»£ç æ’ä»¶æ•°ç»„å…ƒç´ æ ¼å¼

`plugins` æ•°ç»„æ”¯æŒä¸¤ç§å…ƒç´ æ ¼å¼ï¼š

| æ ¼å¼ | è¯´æ˜ | é…ç½®æŸ¥æ‰¾é¡ºåº |
|------|------|-------------|
| `"plugin_name"` | å­—ç¬¦ä¸²ï¼ˆä»£ç æ’ä»¶åç§°ï¼‰ | åº”ç”¨ `plugin_confs` â†’ å…¨å±€é»˜è®¤é…ç½® |
| `{"name": "xxx", "conf": {...}}` | å¯¹è±¡ï¼ˆå†…è”é…ç½®ï¼‰ | ç›´æ¥ä½¿ç”¨ `conf` ä¸­çš„é…ç½® |

**è¯¦ç»†è¯´æ˜è§ï¼š** [5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md](5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md#æ ¸å¿ƒæ¦‚å¿µ2åˆ†é’Ÿç†è§£)

### ç¤ºä¾‹è¯´æ˜

```json
{
  "user_configures": [
                {
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_code",
                    "type_comment": "int,text,bool,json,selectï¼ˆå•é€‰ï¼‰å’Œmult_selectï¼ˆå¤šé€‰ï¼‰ï¼Œå¹¶ä¸”å¢åŠ é¢„é€‰å€¼options. selectå’Œmult_selectçš„æ—¶å€™è¿˜éœ€è¦å®šä¹‰value_type",
                    "type": "int",
                    "value": 403,
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_code"
                },
                {
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_msg",

                    "type": "text",
                    "value": "ç¦æ­¢è®¿é—®",
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_msg"
                },
                {
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_msg",

                    "type": "enum",
                    "value_type": "text",
                    "value": ["ç¦æ­¢è®¿é—®","xxx"],
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_msg"
                }
  ],
  "gw_configures" :{
      "plugin_name": "gitlabæ’ä»¶",
      "plugin_for_app_name": "gitlab",
      "plugin_for_app_version": "V1",
      "plugin_version": "1.0.0",
      "plugin_need_engine_version": "1.0",
      "plugin_author": "TigerSec",
      "plugin_description": "gitlabæ’ä»¶",
      "plugin_last_updated": "2025-12-18",



      "plugins": [
        "redirect",
        "uri_bypass",
        {
          "name": "exposure_auth",
          "conf": {
            "reject_unauthed": true,
            "response_code": 403
          }
        },
        "app_logger"
      ],
      "plugin_confs": {
        "uri_bypass": {
          "filters": ["^/health$"]
        }
      }
    }
}
```
#### æ’ä»¶é…ç½®å¤´è¯´æ˜
```json
  "plugin_name": "gitlabæ’ä»¶",
  "plugin_for_app_name": "gitlab",
  "plugin_for_app_version": "V1",
  "plugin_version": "1.0.0",
  "plugin_need_engine_version": "1.0",
  "plugin_author": "TigerSec",
  "plugin_description": "gitlabæ’ä»¶",
  "plugin_last_updated": "2025-12-18",
```

  ä»¥ä¸Šå­—æ®µå¿…é¡»è¦æœ‰ï¼Œplugin_for_app_nameå’Œplugin_for_app_versionå’Œplugin_descriptionè¦ç»™ç•Œé¢ç”¨æˆ·é€‰æ‹©çš„ã€‚
  plugin_need_engine_version éœ€è¦å¤šå°‘ç‰ˆæœ¬ä¹‹ä¸Šçš„å¼•æ“


#### ä¸Šè¿°é…ç½®ä¸­ï¼š
- `"redirect"` - å­—ç¬¦ä¸²æ ¼å¼ï¼Œåœ¨ `plugin_confs` ä¸­æœªå®šä¹‰ï¼Œä½¿ç”¨**å…¨å±€é»˜è®¤é…ç½®**
- `"uri_bypass"` - å­—ç¬¦ä¸²æ ¼å¼ï¼Œä½¿ç”¨ `plugin_confs` ä¸­å®šä¹‰çš„**åº”ç”¨ä½œç”¨åŸŸé…ç½®**
- `{"name": "exposure_auth", ...}` - å¯¹è±¡æ ¼å¼ï¼Œç›´æ¥ä½¿ç”¨**å†…è”çš„ conf é…ç½®**ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
- `"app_logger"` - å­—ç¬¦ä¸²æ ¼å¼ï¼Œåœ¨ `plugin_confs` ä¸­æœªå®šä¹‰ï¼Œä½¿ç”¨**å…¨å±€é»˜è®¤é…ç½®**

## é…ç½®ç»“æ„

### å®Œæ•´é…ç½®ç¤ºä¾‹

```json
{
"user_configures": [
                {
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_code",
                    "type_comment": "int,text,bool,json,selectï¼ˆå•é€‰ï¼‰å’Œmult_selectï¼ˆå¤šé€‰ï¼‰ï¼Œå¹¶ä¸”å¢åŠ é¢„é€‰å€¼options. selectå’Œmult_selectçš„æ—¶å€™è¿˜éœ€è¦å®šä¹‰value_type",
                    "type": "int",
                    "value": 403,
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_code"
                },
                {
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_msg",

                    "type": "text",
                    "value": "ç¦æ­¢è®¿é—®",
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_msg"
                },
                {
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_msg",

                    "type": "enum",
                    "value_type": "text",
                    "value": ["ç¦æ­¢è®¿é—®","xxx"],
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_msg"
                }
  ],
  "gw_configures":{
    "plugin_name": "gitlabæ’ä»¶",
    "plugin_for_app_name": "gitlab",
    "plugin_for_app_version": "V1",
    "plugin_version": "1.0.0",
    "plugin_need_engine_version": "1.0",
    "plugin_author": "TigerSec",
    "plugin_description": "gitlabæ’ä»¶",
    "plugin_last_updated": "2025-12-18",


    "plugins": [
      "redirect",
      "client_ip",
      "uri_bypass",
      "anony_attack_blocker",
      {
        "name": "exposure_auth",
        "conf": {
          "reject_unauthed": true,
          "response_code": 403,
          "response_msg": "ç¦æ­¢è®¿é—®"
        }
      },
      "app_logger"
    ],
    "plugin_group_id": "default_group_id(å¼•ç”¨å·²å®šä¹‰çš„æ’ä»¶ç»„ï¼ˆä¸ plugins äºŒé€‰ä¸€ï¼‰)"
    "sub_routes": [
      {
        "name": "ç™»å½•æ¥å£",
        "plugin_group_id": "login_gid",
        "routes": [
          {
            "uri": "/api/login",
            "methods": ["POST"]
          }
        ]
      },
      {
        "name": "ç§»åŠ¨ç«¯ç™»å½•æ¥å£",
        "plugin_group_id": "mobile_login_gid",
        "routes": [
          {
            "uri": "/api/login",
            "methods": ["POST"],
            "vars": [
              ["$arg_type", "==", "mobile"]
            ]
          }
        ]
      },
      {
        "name": "ç™½åå•æ¥å£",
        "plugins": [],
        "routes": [
          {
            "uri": "/api/public_info",
            "methods": ["GET", "POST"]
          },
          {
            "uri": "/health",
            "methods": ["GET"]
          }
        ]
      }
    ],

    "plugin_groups": {
      "login_gid": [
        "redirect",
        "passwd_restriction",
        {
          "name": "exposure_login",
          "conf": {
            "fetch_vars": {
              "user_id": {
                "source": "response_body",
                "field": "data.user.id",
                "parser": "json"
              }
            },
            "user_id_var": "user_id",
            "success_expr": ["AND",
              ["${upstream_status}", "==", 200],
              ["${user_id}", "!=", ""]
            ],
            "log_request": true
          }
        },
        "gzip"
      ],
      "mobile_login_gid": [
        "redirect",
        "passwd_restriction",
        {
          "name": "exposure_login",
          "conf": {
            "fetch_vars": {
              "user_id": {
                "source": "response_body",
                "field": "data.uid",
                "parser": "json"
              }
            },
            "success_expr": ["${upstream_status}", "==", 200],
            "user_id_var": "${user_id}"

          }
        },
        "gzip"
      ]
    },

    "plugin_confs": {
      "anony_attack_blocker": {
        "allow_request": false,
        "policy": "local"
      },
      "passwd_bruteforce": {
        "allow_degradation": false,
        "rejected_msg": "{\"code\":10206,\"msg\":\"éæ³•æ”»å‡»\",\"status\":false}"
      },
      "passwd_restriction": {
        "rejected_code": 200,
        "rejected_msg": "å¼±å¯†ç ç¦æ­¢ç™»å½•",
        "block_request": false
      },
      "uri_bypass": {
        "filters": [
          "^/public/.*",
          "^/static/.*"
        ]
      },
      "exposure_user": {
        "key_name":"xxxxx",
        "sub_requests": [
          {
            "name": "get_user",
            "desc": "è·å–ç”¨æˆ·",
            "uri": "/api/userinfo",
            "method": "GET",
            "headers": {
              "Cookie": "$http_cookie"
            },
            "fetch_vars": {
              "user_id": {
                "source": "response_body",
                "field": "data.uid",
                "parser": "json"
              }
            },
            "success_expr": ["${upstream_status}", "==", 200],
          }
        ],
        "user_id_var": "${get_user.user_id}",
        "user_name_var": "${get_user.user_name}"
      }
    }
  }
}
```

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| ç‰ˆæœ¬ä¿¡æ¯å­—æ®µ | è‹¥å¹²ç‰ˆæœ¬ä¿¡æ¯å­—æ®µï¼Œå¿…å¡« |
| `user_configures` | æä¾›ç”¨æˆ·ç•Œé¢é…ç½®é¡¹ç›® ï¼Œé€‰é¡¹ |
| `plugins` | åº”ç”¨ä¸»æ’ä»¶ç»„ï¼Œç›´æ¥å®šä¹‰æ’ä»¶åˆ—è¡¨ï¼Œå¤„ç†é™¤ç‰¹æ®Šæ¥å£å¤–çš„æ‰€æœ‰è¯·æ±‚ |
| `plugin_group_id` | å¼•ç”¨å·²å®šä¹‰çš„æ’ä»¶ç»„ IDï¼Œä¸ `plugins` **äºŒé€‰ä¸€**ï¼Œ`plugins` ä¼˜å…ˆçº§æ›´é«˜ |
| `sub_routes` | å­è·¯ç”±é…ç½®ï¼Œç”¨äºç‰¹æ®Šæ¥å£ï¼ˆå¦‚ç™»å½•æ¥å£ï¼‰ä½¿ç”¨ä¸åŒçš„æ’ä»¶ç»„ |
| `plugin_groups` | åº”ç”¨ä½œç”¨åŸŸçš„æ’ä»¶ç»„å®šä¹‰ï¼Œå¯è¢«å­è·¯ç”±æˆ– `plugin_group_id` å¼•ç”¨ |
| `plugin_confs` | åº”ç”¨ä½œç”¨åŸŸçš„æ’ä»¶é…ç½®ï¼Œæ’ä»¶ç»„å†…åªå†™æ’ä»¶åæ—¶ä»æ­¤å¤„æŸ¥æ‰¾é…ç½® |

**æ³¨æ„**ï¼š`plugins` å’Œ `plugin_group_id` äºŒé€‰ä¸€é…ç½®ï¼š
- `plugins`ï¼šç›´æ¥åœ¨åº”ç”¨é…ç½®ä¸­å®šä¹‰æ’ä»¶åˆ—è¡¨
- `plugin_group_id`ï¼šå¼•ç”¨ `plugin_groups` ä¸­å®šä¹‰çš„æ’ä»¶ç»„ï¼Œé€‚åˆæ’ä»¶ç»„å¤ç”¨åœºæ™¯
- å¦‚æœåŒæ—¶é…ç½®ï¼Œ`plugins` ä¼˜å…ˆçº§æ›´é«˜

### ç”¨æˆ·ç•Œé¢é…ç½®
```json
 "user_configures": [
                {
                    "label":"æœªè®¤è¯è¯·æ±‚",
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_code",
                    "type_comment": "int,text,bool,json,selectï¼ˆå•é€‰ï¼‰å’Œmult_selectï¼ˆå¤šé€‰ï¼‰ï¼Œå¹¶ä¸”å¢åŠ é¢„é€‰å€¼options. selectå’Œmult_selectçš„æ—¶å€™è¿˜éœ€è¦å®šä¹‰value_type",
                    "type": "int",
                    "value": 403,
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_code"
                },
                {
                    "label":"æœªè®¤è¯è¯·æ±‚è¿”å›ä¿¡æ¯",
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_msg",

                    "type": "text",
                    "value": "ç¦æ­¢è®¿é—®",
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_msg"
                },
                {
                    "label":"æœªè®¤è¯è¯·æ±‚è¿”å›ä¿¡æ¯",
                    "json_path": "gw_configures.plugins.exposure_auth.conf.response_msg",

                    "type": "enum",
                    "value_type": "text",
                    "value": ["ç¦æ­¢è®¿é—®","xxx"],
                    "description": "æ²¡æœ‰è®¤è¯çš„æµé‡å¤„ç†æ–¹å¼ response_msg"
                }
  ]
  ```
  **å­—æ®µè¯´æ˜**ï¼š
  - `label`ï¼š label å±•ç¤ºç»™ç”¨æˆ·çœ‹çš„æ ‡ç­¾
  - `json_path`ï¼š jsonè·¯å¾„ï¼Œç•Œé¢ä¼šæŒ‰ç…§é…ç½®ç”¨æˆ·é…ç½®è‡ªå®šåˆ¶çš„å€¼ï¼Œç•Œé¢ä¿å­˜çš„æ—¶å€™ä¼šæ›¿æ¢å¯¹åº”çš„json_pathçš„å¯¹åº”çš„å€¼
  - `type`: å­—æ®µç±»å‹ï¼Œint,text,bool,json,selectï¼ˆå•é€‰ï¼‰å’Œmult_selectï¼ˆå¤šé€‰ï¼‰ï¼Œå¹¶ä¸”å¢åŠ é¢„é€‰å€¼options. selectå’Œmult_selectçš„æ—¶å€™è¿˜éœ€è¦å®šä¹‰value_type
  - `value`ï¼šå­—æ®µå€¼ï¼Œå½“typeä¸ºselect/mult_selectçš„æ—¶å€™ï¼Œvalueä¸ºæ•°ç»„ï¼Œæ•°ç»„é‡Œçš„å­—æ®µç±»å‹ä¸ºvalue_typeæŒ‡å®š
  - `value_type`ï¼šåªæœ‰åœ¨select/mult_selectçš„æ—¶å€™æ‰æœ‰æ•ˆ
  - `description`ï¼šå±•ç¤ºç»™ç”¨æˆ·çœ‹çš„æè¿°

### å­è·¯ç”±é…ç½®

å­è·¯ç”±ç”¨äºä¸ºç‰¹æ®Šæ¥å£é…ç½®ä¸åŒçš„æ’ä»¶ç»„ã€‚ä½¿ç”¨ `resty.radixtree`ï¼ˆåŸºæ•°æ ‘ï¼‰è¿›è¡Œé«˜æ•ˆçš„è·¯å¾„åŒ¹é…ã€‚

**æ³¨æ„**ï¼šç”±äºä¸»åº”ç”¨å·²ç»æ ¹æ® Host è¿›è¡Œäº†åŒ¹é…ï¼Œå­è·¯ç”±åŒ¹é…æ—¶**ä¸å†è¿›è¡Œ Host åŒ¹é…**ï¼Œä»…åŒ¹é… URIã€HTTP æ–¹æ³•å’Œè‡ªå®šä¹‰æ¡ä»¶ã€‚

è¯¦ç»†é…ç½®è¯´æ˜è§ [sub-route.md](sub-route.md)ã€‚


```json
{
  "name": "å­è·¯ç”±åç§°",
  "plugin_group_id": "å¼•ç”¨çš„æ’ä»¶ç»„ID",
  "routes": [
    {
      "uri": "/api/login",
      "methods": ["POST"],
      "vars": [
        ["$arg_type", "==", "mobile"]
      ]
    }
  ]
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `uri` / `uris` - åŒ¹é…çš„ URI è·¯å¾„ï¼ˆæ”¯æŒç²¾ç¡®åŒ¹é…ã€å‰ç¼€åŒ¹é… `/*`ã€å‚æ•°åŒ¹é… `/:id`ï¼‰
- `methods` - åŒ¹é…çš„ HTTP æ–¹æ³•
- `vars` - é¢å¤–çš„åŒ¹é…æ¡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼Œä½¿ç”¨ [lua-resty-expr](lua-resty-expr.md) è¯­æ³•

**vars å˜é‡æ¥æº**ï¼š`vars` ä¸­å‚ä¸åŒ¹é…çš„å˜é‡æ¥æºäº `ctx.var`ï¼Œä¸ºå¹³å°å†…ç½®å˜é‡ï¼ˆåŒ…æ‹¬ WEBéšèº«ç›¾ å˜é‡ï¼‰ï¼Œå¸¸ç”¨å˜é‡å¦‚ï¼š
- `arg_xxx` - URL æŸ¥è¯¢å‚æ•°
- `http_xxx` - è¯·æ±‚å¤´ï¼ˆå¦‚ `http_user_agent`ï¼‰
- `cookie_xxx` - Cookie å€¼
- `remote_addr` - å®¢æˆ·ç«¯ IP
- `uri`ã€`host`ã€`method` ç­‰ WEBéšèº«ç›¾ å†…ç½®å˜é‡

è¯¦ç»†å˜é‡åˆ—è¡¨è§ [ctx-var.md](ctx-var.md)ã€‚

## ç™½åå•é…ç½®

æ”¯æŒä¸¤ç§æ–¹å¼é…ç½®ç™½åå• URLï¼Œè·³è¿‡å®‰å…¨æ£€æµ‹ï¼š

| æ–¹å¼ | æ’ä»¶/é…ç½® | æ€§èƒ½ | é€‚ç”¨åœºæ™¯ |
|------|----------|------|---------|
| å­è·¯ç”±ç™½åå• | `sub_routes` + `plugins: []` | **æ›´é«˜**ï¼ˆåŸºæ•°æ ‘åŒ¹é…ï¼‰ | éœ€è¦ HTTP æ–¹æ³•æˆ–æ¡ä»¶åŒ¹é… |
| æ­£åˆ™ç™½åå• | `uri_bypass` | ä¸€èˆ¬ï¼ˆæ­£åˆ™åŒ¹é…ï¼‰ | éœ€è¦å¤æ‚æ­£åˆ™åŒ¹é…ï¼ˆå¦‚æ‰©å±•åï¼‰ |

**è¯¦ç»†é…ç½®è¯´æ˜è§ï¼š** [ç™½åå•.md](ç™½åå•.md)

## é€‚é…æµç¨‹

é’ˆå¯¹æš´éœ²é¢æ”¶æ•›åœºæ™¯ï¼Œåº”ç”¨é€‚é…ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1. **åˆ†æåº”ç”¨è®¤è¯æœºåˆ¶**ï¼šç¡®å®šç™»å½•æ¥å£ã€è®¤è¯å‡­æ®ã€ç™»å½•æˆåŠŸæ ‡è¯†
2. **åˆ†æç”¨æˆ·ä¿¡æ¯è·å–æ¥å£**ï¼šæ‰¾åˆ°å¯éªŒè¯ç™»å½•çŠ¶æ€å¹¶è·å–ç”¨æˆ·ä¿¡æ¯çš„æ¥å£
3. **åˆ†æç™½åå•æ¥å£**ï¼šæ¢³ç†æ— éœ€è®¤è¯å³å¯è®¿é—®çš„æ¥å£
4. **é…ç½®æ ¸å¿ƒä»£ç æ’ä»¶**ï¼š`exposure_session`ã€`exposure_user`ã€`exposure_auth`ã€`exposure_login`
5. **é…ç½®ç™½åå•**ï¼šä½¿ç”¨å­è·¯ç”±æˆ–æ­£åˆ™ç™½åå•
6. **æµ‹è¯•éªŒè¯**ï¼šéªŒè¯ç™»å½•ã€è®¤è¯ã€ç™½åå•ç­‰åŠŸèƒ½

**è¯¦ç»†åˆ†æ­¥é…ç½®æŒ‡å—è§ï¼š** [5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md](5åˆ†é’Ÿç¼–å†™åº”ç”¨æ’ä»¶.md#åˆ†æ­¥é…ç½®æŒ‡å—)

## å‚è€ƒé“¾æ¥

- [exposure_auth æ’ä»¶é…ç½®](exposure_auth.md)
- [exposure_login æ’ä»¶é…ç½®](exposure_login.md)
- [exposure_user æ’ä»¶é…ç½®](exposure_user.md)
- [æ­£åˆ™ç™½åå• URI é…ç½®](uri_bypass.md)
- [å­è·¯ç”±é…ç½®](sub-route.md)
- [è¯·æ±‚ä¸Šä¸‹æ–‡å˜é‡](ctx-var.md)
- [lua-resty-expr è¡¨è¾¾å¼è¯­æ³•](lua-resty-expr.md)
- [è·¯å¾„æå–è¯­æ³•](path-syntax.md)
